# 一、项目背景

在 RoboMaster 2026 机甲大师高校系列赛中，英雄机器人在开启部署模式进行吊射时，允许通过图传链路向操作手自定义客户端发送数据。官方通信协议中规定了专用的图传通信命令码（0x0310）及严格的带宽限制。在此背景下，需要设计并实现一套**在极低带宽条件下可用、稳定、对操作手有实际辅助价值**的信息传输方案。

本需求文档基于：

* 《RoboMaster 2026 机甲大师高校系列赛通信协议》
* 《RoboMaster 2026 机甲大师超级对抗赛比赛规则》
* 已有技术调研文档与聊天记录讨论结论

目标是明确系统需要“做什么”“做到什么程度”，而非限定具体实现细节。

---

# 二、通信与约束条件

## 2.1 通信机制约束

* 通信命令码：0x0310（英雄图传通信命令）
* 通信方向：英雄机器人 → 操作手自定义客户端
* 生效条件：仅在英雄开启部署模式进行吊射时允许通信

## 2.2 带宽与频率限制

* 单数据包数据段长度：150 Byte
* 最大发送频率：50 Hz
* 理论带宽上限：

  * 150 Byte × 8 × 50 = 60000 bps = **60 Kbps**

该带宽为**硬约束**，所有设计均需在此上限内稳定运行，并预留一定安全冗余。

---

# 三、总体目标

在不超过 60 Kbps 的带宽条件下，向英雄操作手提供：

* 可用于**环境态势判断**的简化视觉信息
* 可用于**辅助吊射调参**的关键结构化信息

最终目标不是“高清画面”，而是**提升吊射效率与命中稳定性**。

---

# 四、功能需求

## 4.1 信息类型划分

系统发送的信息分为两大类：

1. 图像信息
2. 辅助信息

两类信息可独立设计、组合发送，具体比例可根据实验效果动态调整。

---

## 4.2 图像信息需求

### 4.2.1 基本定位

* 图像用途：

  * 提供吊射场景的**大致环境感知**
  * 辅助操作手理解落点与目标的大体关系
* 不追求画面清晰度或细节完整度

### 4.2.2 图像处理要求

* 原始图像需经过**强精简处理**，以降低信息熵
* 允许且鼓励：

  * 灰阶压缩（如 2~4 bit 灰阶）
  * 分辨率大幅降低
  * 阈值化、自适应光照处理

示例参考方案（非强制）：

* 原始分辨率：1350 × 1080
* 精简后：约 120 × 90
* 灰阶数：4 级（2 bit）
* 精简后理论数据量：约 21600 bit / frame

### 4.2.3 帧率与带宽分配

* 推荐图像帧率：≤ 5 fps
* 单帧目标大小：≤ 12000 bit
* 图像总带宽应控制在整体带宽的可调比例内（如 50%~80%）

---

## 4.3 辅助信息需求

### 4.3.1 设计动机

在极低带宽条件下，单纯依赖图像难以提供“清晰落点反馈”。而吊射操作本质是一个：

**试击打 → 判断落点 → 调整弹道** 的循环过程。

因此，将“判断落点”这一环节中的关键结果直接传输给操作手，可以显著降低操作难度。

### 4.3.2 辅助信息内容（示例）

* 英雄大弹丸落点相对于目标（如基地装甲板中心）的：

  * 横向偏移量
  * 纵向偏移量
  * 偏移方向
* 是否命中判定（若可行）

### 4.3.3 数据特性要求

* 强结构化
* 低数据量（Byte 级或十几 Byte 级）
* 高可靠性，优先级高于图像数据

### 4.3.4 实验与验证需求

* 需要采集真实吊射场景下的大弹丸落点图像样本
* 用于验证落点识别与相对位置计算的可行性与稳定性

---

# 五、编码与压缩需求

## 5.1 基本原则

* 编码与解码方案需：

  * 稳定
  * 可复现
  * 易于与电控侧对接

## 5.2 可选技术路线（非排他）

### 路线 A：成熟视频编码方案

* 示例：H.264 / H.265 / AV1
* 工具链：ffmpeg 等
* 特点：

  * 视觉压缩效率高
  * 实现成熟
  * 对解码端性能与环境要求较高

### 路线 B：自定义轻量编码方案

* 示例：

  * 游程编码（RLE）
  * 哈夫曼编码
  * 针对四值图的定制编码
* 特点：

  * 可控性强
  * 实现复杂度低
  * 更适合极低带宽与嵌入式场景

最终方案需根据实验结果与电控侧实现成本综合评估。

---

# 六、非功能性需求

* 稳定性：长时间运行不丢包、不阻塞
* 实时性：延迟应满足吊射调整节奏
* 可扩展性：

  * 允许调整灰阶数、分辨率、帧率
  * 允许动态调整图像与辅助信息的带宽占比

---

# 七、协作与接口需求

* 需与电控组明确：

  * 数据包格式
  * 编码 / 解码方式
  * 字节序与对齐方式
* 客户端需支持：

  * 图像解码与显示
  * 辅助信息的可视化呈现（如偏移提示）

---

# 八、阶段性交付物（建议）

* 图像精简与压缩方案实验报告
* 辅助信息计算与验证结果
* 最终通信数据包格式说明
* 带宽占用与稳定性测试结果

---

# 九、结语

本需求文档的核心目标是：

**在 60 Kbps 的极限条件下，把每一 bit 都变成对操作手“有用的信息”。**

具体实现路径允许探索与试错，但需始终围绕“实战可用性”这一唯一评价标准。
